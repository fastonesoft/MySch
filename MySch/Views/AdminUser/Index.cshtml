@{
    Layout = null;
    //AdminUser
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>用户列表</title>

    <script type="text/javascript">
        $(function () {

            //点击动作
            users = {
                add: function () {
                    DataGridNone('AdminUser', 'AddUser');
                },
                edit: function () {
                    DataGridRow('#users-grid', 'AdminUser', 'EditUser');
                },
                del: function () {
                    DataGridRow('#users-grid', 'AdminUser', 'DelUser');
                },
                search: function () {
                    var text = $.trim($('#users-grid-text').val());
                    if (text.length == 0) {
                        //刷新
                        $('#users-grid').datagrid('load');
                    } else {
                        $('#users-grid').datagrid('loading');
                        //读取部分
                        $.post('/AdminUser/SearchUser', { text: text }, function (d) {
                            if (d.error) {
                                $.messager.alert('错误提示', d.message, 'error');
                            } else {
                                $('#users-grid').datagrid('loadData', d);
                                $('#users-grid').datagrid('loaded');
                            }
                        });
                    }
                },
            }

            //数据表格
            $('#users-grid').datagrid({
                fit: true,
                striped: true,
                rownumbers: true,
                fitColumns: false,
                remoteSort: false,
                singleSelect: true,
                checkOnSelect: true,
                url: '/Admin/UsersPage',
                loadFilter: function (d) {
                    if (d.error) {
                        $.messager.alert('错误提示', d.message, 'error');
                        return { total: 0, rows: [] };
                    } else {
                        return d;
                    }
                },

                columns: [[
                    { title: '帐号', field: 'IDS', align: 'center', sortable: true, width: 150 },
                    { title: '名称', field: 'Name', align: 'center', sortable: true, width: 100 },
                    {
                        title: '注册时间', field: 'RegTime', align: 'center', sortable: true, width: 150,
                        formatter: function (value, row, index) {
                            //日期整形
                            return formatDate(value);
                        }
                    },
                    {
                        title: '是否可用', field: 'Fixed', halign: 'center', width: 80,
                        formatter: function (value, row, index) {
                            //不输出任何东西
                            //return value.ok ? null : value.message;
                        },
                        styler: function (value, row, index) {
                            if (!value) {
                                return "background:url('/Content/themes/icons/ico_yes.gif') no-repeat center center;";
                            } else {
                                return "background:url('/Content/themes/icons/ico_del.png') no-repeat center center;";
                            }
                        }
                    }
                ]],

                toolbar: '#users-grid-tool',
                pagination: true,
                pageSize: 100,
                pageList: [100, 200, 500],
                pageNumber: 1,
            });
        })
    </script>
</head>
<body>
    <table id="users-grid"></table>
    <div id="users-grid-tool">
        <table cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <td>
                        <a href="javascript:void(0);" class="easyui-linkbutton" iconcls="icon-add" plain="true" onclick="users.add();">添加</a>
                    </td>
                    <td>
                        <div class="datagrid-btn-separator"></div>
                    </td>
                    <td>
                        <a href="javascript:void(0);" class="easyui-linkbutton" iconcls="icon-edit" plain="true" onclick="users.edit();">修改</a>
                    </td>
                    <td>
                        <div class="datagrid-btn-separator"></div>
                    </td>
                    <td>
                        <a href="javascript:void(0);" class="easyui-linkbutton" iconcls="icon-no" plain="true" onclick="users.del();">删除</a>
                    </td>
                    <td style="width:5px;"></td>
                    <td>
                        <span class="textbox">
                            <input class="textbox-text" id="users-grid-text" />
                        </span>
                    </td>
                    <td style="padding-left:5px;">
                        <a href="javascript:void(0);" class="easyui-linkbutton" iconcls="icon-search" plain="true" onclick="users.search();">查询</a>
                    </td>
                </tr>
            </thead>
        </table>
    </div>
</body>
</html>
